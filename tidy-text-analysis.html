<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title> 8 Tidy text analysis | Data journalism</title>
  <meta name="description" content=" 8 Tidy text analysis | Data journalism - M.A. Seminar at the IfKW, WS 2022/23" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content=" 8 Tidy text analysis | Data journalism" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content=" 8 Tidy text analysis | Data journalism - M.A. Seminar at the IfKW, WS 2022/23" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content=" 8 Tidy text analysis | Data journalism" />
  
  <meta name="twitter:description" content=" 8 Tidy text analysis | Data journalism - M.A. Seminar at the IfKW, WS 2022/23" />
  

<meta name="author" content="Lara Kobilke, IfKW, Ludwig-Maximilians-Universität München" />


<meta name="date" content="2023-02-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="exercise-5-test-your-knowledge.html"/>
<link rel="next" href="solutions.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Data Journalism</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>General information on the course</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-can-i-learn-from-this-tutorial"><i class="fa fa-check"></i>What can I learn from this tutorial?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-can-i-do-if-i-have-a-question"><i class="fa fa-check"></i>What can I do if I have a question?</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#what-can-i-do-if-i-have-problems-with-my-r-code"><i class="fa fa-check"></i>What can I do if I have problems with my R code?</a></li>
</ul></li>
<li class="chapter" data-level="1" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html"><i class="fa fa-check"></i><b>1</b> Tutorial: Installing &amp; Understanding R/R Studio</a>
<ul>
<li class="chapter" data-level="1.1" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#installing-r"><i class="fa fa-check"></i><b>1.1</b> Installing R</a></li>
<li class="chapter" data-level="1.2" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#installing-r-studio"><i class="fa fa-check"></i><b>1.2</b> Installing R Studio</a></li>
<li class="chapter" data-level="1.3" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#updating-r-and-r-studio"><i class="fa fa-check"></i><b>1.3</b> Updating R and R Studio</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#on-windows"><i class="fa fa-check"></i><b>1.3.1</b> On Windows</a></li>
<li class="chapter" data-level="1.3.2" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#on-mac"><i class="fa fa-check"></i><b>1.3.2</b> On MAC</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#how-does-r-work"><i class="fa fa-check"></i><b>1.4</b> How does R work?</a></li>
<li class="chapter" data-level="1.5" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#why-should-i-use-r"><i class="fa fa-check"></i><b>1.5</b> Why should I use R?</a></li>
<li class="chapter" data-level="1.6" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#how-does-r-studio-work"><i class="fa fa-check"></i><b>1.6</b> How does R Studio work?</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#source-writing-your-own-code"><i class="fa fa-check"></i><b>1.6.1</b> Source: Writing your own code</a></li>
<li class="chapter" data-level="1.6.2" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#console-printing-results"><i class="fa fa-check"></i><b>1.6.2</b> Console: Printing results</a></li>
<li class="chapter" data-level="1.6.3" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#environment-overview-of-objects"><i class="fa fa-check"></i><b>1.6.3</b> Environment: Overview of objects</a></li>
<li class="chapter" data-level="1.6.4" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#plotshelppackages-do-everything-else"><i class="fa fa-check"></i><b>1.6.4</b> Plots/Help/Packages: Do everything else</a></li>
</ul></li>
<li class="chapter" data-level="1.7" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#packages"><i class="fa fa-check"></i><b>1.7</b> Packages</a>
<ul>
<li class="chapter" data-level="1.7.1" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#installing-packages"><i class="fa fa-check"></i><b>1.7.1</b> Installing packages</a></li>
<li class="chapter" data-level="1.7.2" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#activating-packages"><i class="fa fa-check"></i><b>1.7.2</b> Activating packages</a></li>
<li class="chapter" data-level="1.7.3" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#getting-information-about-packages"><i class="fa fa-check"></i><b>1.7.3</b> Getting information about packages</a></li>
</ul></li>
<li class="chapter" data-level="1.8" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#take-aways"><i class="fa fa-check"></i><b>1.8</b> Take-Aways</a></li>
<li class="chapter" data-level="1.9" data-path="tutorial-installing-understanding-rr-studio.html"><a href="tutorial-installing-understanding-rr-studio.html#additional-tutorials"><i class="fa fa-check"></i><b>1.9</b> Additional tutorials</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="tutorial-using-r-as-a-calculator.html"><a href="tutorial-using-r-as-a-calculator.html"><i class="fa fa-check"></i><b>2</b> Tutorial: Using R as a calculator</a>
<ul>
<li class="chapter" data-level="2.1" data-path="tutorial-using-r-as-a-calculator.html"><a href="tutorial-using-r-as-a-calculator.html#using-variables-for-calculation"><i class="fa fa-check"></i><b>2.1</b> Using variables for calculation</a></li>
<li class="chapter" data-level="2.2" data-path="tutorial-using-r-as-a-calculator.html"><a href="tutorial-using-r-as-a-calculator.html#using-vectors-for-calculation"><i class="fa fa-check"></i><b>2.2</b> Using vectors for calculation</a></li>
<li class="chapter" data-level="2.3" data-path="tutorial-using-r-as-a-calculator.html"><a href="tutorial-using-r-as-a-calculator.html#selecting-values-from-a-vector"><i class="fa fa-check"></i><b>2.3</b> Selecting values from a vector</a></li>
<li class="chapter" data-level="2.4" data-path="tutorial-using-r-as-a-calculator.html"><a href="tutorial-using-r-as-a-calculator.html#take-aways-1"><i class="fa fa-check"></i><b>2.4</b> Take-Aways</a></li>
<li class="chapter" data-level="2.5" data-path="tutorial-using-r-as-a-calculator.html"><a href="tutorial-using-r-as-a-calculator.html#additional-tutorials-1"><i class="fa fa-check"></i><b>2.5</b> Additional tutorials</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html"><i class="fa fa-check"></i><b>3</b> Tutorial: Working with data (files)</a>
<ul>
<li class="chapter" data-level="3.1" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#defining-your-working-directory"><i class="fa fa-check"></i><b>3.1</b> Defining your working directory</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#optional-setting-the-working-directory-on-a-remote-desktop"><i class="fa fa-check"></i><b>3.1.1</b> Optional: Setting the working directory on a remote desktop</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#import-data-from-your-working-directory"><i class="fa fa-check"></i><b>3.2</b> Import data from your working directory</a></li>
<li class="chapter" data-level="3.3" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#subsetting-variables-columns-in-data-frames"><i class="fa fa-check"></i><b>3.3</b> Subsetting variables / columns in data frames</a></li>
<li class="chapter" data-level="3.4" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#subsetting-observations-rows-in-data-frames"><i class="fa fa-check"></i><b>3.4</b> Subsetting observations / rows in data frames</a></li>
<li class="chapter" data-level="3.5" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#subsetting-values-cells-in-data-frames"><i class="fa fa-check"></i><b>3.5</b> Subsetting values / cells in data frames</a></li>
<li class="chapter" data-level="3.6" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#subsetting-data-with-conditions"><i class="fa fa-check"></i><b>3.6</b> Subsetting data with conditions</a></li>
<li class="chapter" data-level="3.7" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#take-aways-2"><i class="fa fa-check"></i><b>3.7</b> Take-Aways</a></li>
<li class="chapter" data-level="3.8" data-path="tutorial-working-with-data-files.html"><a href="tutorial-working-with-data-files.html#additional-tutorials-2"><i class="fa fa-check"></i><b>3.8</b> Additional tutorials</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html"><i class="fa fa-check"></i>Exercise 1</a>
<ul>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-1"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-2"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-3"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-4"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-5"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="exercise-1.html"><a href="exercise-1.html#task-6"><i class="fa fa-check"></i>Task 6</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html"><i class="fa fa-check"></i><b>4</b> Tutorial: Data management with tidyverse</a>
<ul>
<li class="chapter" data-level="4.1" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#why-not-stick-with-base-r"><i class="fa fa-check"></i><b>4.1</b> Why not stick with Base R?</a></li>
<li class="chapter" data-level="4.2" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#tidyverse-packages"><i class="fa fa-check"></i><b>4.2</b> Tidyverse packages</a></li>
<li class="chapter" data-level="4.3" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#tidy-data"><i class="fa fa-check"></i><b>4.3</b> Tidy data</a></li>
<li class="chapter" data-level="4.4" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#the-pipe-operator"><i class="fa fa-check"></i><b>4.4</b> The pipe operator</a></li>
<li class="chapter" data-level="4.5" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#data-transformation-with-dplyr"><i class="fa fa-check"></i><b>4.5</b> Data transformation with dplyr</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#select"><i class="fa fa-check"></i><b>4.5.1</b> select()</a></li>
<li class="chapter" data-level="4.5.2" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#filter"><i class="fa fa-check"></i><b>4.5.2</b> filter()</a></li>
<li class="chapter" data-level="4.5.3" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#arrange"><i class="fa fa-check"></i><b>4.5.3</b> arrange()</a></li>
<li class="chapter" data-level="4.5.4" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#mutate"><i class="fa fa-check"></i><b>4.5.4</b> mutate()</a></li>
<li class="chapter" data-level="4.5.5" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#summarize-group_by"><i class="fa fa-check"></i><b>4.5.5</b> summarize() [+ group_by()]</a></li>
<li class="chapter" data-level="4.5.6" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#chaining-functions-in-a-pipe"><i class="fa fa-check"></i><b>4.5.6</b> Chaining functions in a pipe</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#take-aways-3"><i class="fa fa-check"></i><b>4.6</b> Take-Aways</a></li>
<li class="chapter" data-level="4.7" data-path="tutorial-data-management-with-tidyverse.html"><a href="tutorial-data-management-with-tidyverse.html#additional-tutorials-3"><i class="fa fa-check"></i><b>4.7</b> Additional tutorials</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-2-test-your-knowledge.html"><a href="exercise-2-test-your-knowledge.html"><i class="fa fa-check"></i>Exercise 2: Test your knowledge</a>
<ul>
<li class="chapter" data-level="" data-path="exercise-2-test-your-knowledge.html"><a href="exercise-2-test-your-knowledge.html#task-1-1"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="exercise-2-test-your-knowledge.html"><a href="exercise-2-test-your-knowledge.html#task-2-1"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-2-test-your-knowledge.html"><a href="exercise-2-test-your-knowledge.html#task-3-1"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="exercise-2-test-your-knowledge.html"><a href="exercise-2-test-your-knowledge.html#task-4-1"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="exercise-2-test-your-knowledge.html"><a href="exercise-2-test-your-knowledge.html#task-5-1"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="exercise-2-test-your-knowledge.html"><a href="exercise-2-test-your-knowledge.html#task-6-1"><i class="fa fa-check"></i>Task 6</a></li>
<li class="chapter" data-level="" data-path="exercise-2-test-your-knowledge.html"><a href="exercise-2-test-your-knowledge.html#task-7"><i class="fa fa-check"></i>Task 7</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html"><i class="fa fa-check"></i><b>5</b> Tutorial: Data visualization with ggplot</a>
<ul>
<li class="chapter" data-level="5.1" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#why-not-stick-with-base-r-1"><i class="fa fa-check"></i><b>5.1</b> Why not stick with Base R?</a></li>
<li class="chapter" data-level="5.2" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#components-of-a-ggplot-graph"><i class="fa fa-check"></i><b>5.2</b> Components of a ggplot graph</a></li>
<li class="chapter" data-level="5.3" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#installing-activating-ggplot"><i class="fa fa-check"></i><b>5.3</b> Installing &amp; activating ggplot</a></li>
<li class="chapter" data-level="5.4" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#building-your-first-plot"><i class="fa fa-check"></i><b>5.4</b> Building your first plot</a>
<ul>
<li class="chapter" data-level="5.4.1" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#data"><i class="fa fa-check"></i><b>5.4.1</b> Data</a></li>
<li class="chapter" data-level="5.4.2" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#aesthetics"><i class="fa fa-check"></i><b>5.4.2</b> Aesthetics</a></li>
<li class="chapter" data-level="5.4.3" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#geometrics"><i class="fa fa-check"></i><b>5.4.3</b> Geometrics</a></li>
<li class="chapter" data-level="5.4.4" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#scales"><i class="fa fa-check"></i><b>5.4.4</b> Scales</a></li>
<li class="chapter" data-level="5.4.5" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#themes"><i class="fa fa-check"></i><b>5.4.5</b> Themes</a></li>
<li class="chapter" data-level="5.4.6" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#labs"><i class="fa fa-check"></i><b>5.4.6</b> Labs</a></li>
<li class="chapter" data-level="5.4.7" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#facets"><i class="fa fa-check"></i><b>5.4.7</b> Facets</a></li>
<li class="chapter" data-level="5.4.8" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#saving-graphs"><i class="fa fa-check"></i><b>5.4.8</b> Saving graphs</a></li>
</ul></li>
<li class="chapter" data-level="5.5" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#other-common-plot-types"><i class="fa fa-check"></i><b>5.5</b> Other common plot types</a>
<ul>
<li class="chapter" data-level="5.5.1" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#bar-plots"><i class="fa fa-check"></i><b>5.5.1</b> bar plots</a></li>
<li class="chapter" data-level="5.5.2" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#box-plots"><i class="fa fa-check"></i><b>5.5.2</b> box plots</a></li>
</ul></li>
<li class="chapter" data-level="5.6" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#take-aways-4"><i class="fa fa-check"></i><b>5.6</b> Take Aways</a></li>
<li class="chapter" data-level="5.7" data-path="tutorial-data-visualization-with-ggplot.html"><a href="tutorial-data-visualization-with-ggplot.html#additional-tutorials-4"><i class="fa fa-check"></i><b>5.7</b> Additional tutorials</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-3-test-your-knowledge.html"><a href="exercise-3-test-your-knowledge.html"><i class="fa fa-check"></i>Exercise 3: Test your knowledge</a>
<ul>
<li class="chapter" data-level="" data-path="exercise-3-test-your-knowledge.html"><a href="exercise-3-test-your-knowledge.html#task-1-2"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="exercise-3-test-your-knowledge.html"><a href="exercise-3-test-your-knowledge.html#task-2-2"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-3-test-your-knowledge.html"><a href="exercise-3-test-your-knowledge.html#task-3-2"><i class="fa fa-check"></i>Task 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html"><i class="fa fa-check"></i>Exercise 4: Test your knowledge</a>
<ul>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html#task-1-3"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html#task-2-3"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html#task-3-3"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html#task-4-2"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html#task-5-2"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html#task-6-2"><i class="fa fa-check"></i>Task 6</a></li>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html#task-7-1"><i class="fa fa-check"></i>Task 7</a></li>
<li class="chapter" data-level="" data-path="exercise-4-test-your-knowledge.html"><a href="exercise-4-test-your-knowledge.html#task-8"><i class="fa fa-check"></i>Task 8</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html"><i class="fa fa-check"></i><b>6</b> Tutorial: Text manipulation with stringr</a>
<ul>
<li class="chapter" data-level="6.1" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#whats-stringr"><i class="fa fa-check"></i><b>6.1</b> What’s stringr?</a></li>
<li class="chapter" data-level="6.2" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#working-with-strings"><i class="fa fa-check"></i><b>6.2</b> Working with strings</a></li>
<li class="chapter" data-level="6.3" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#working-with-string-patterns"><i class="fa fa-check"></i><b>6.3</b> Working with string patterns</a></li>
<li class="chapter" data-level="6.4" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#working-with-regular-expressions"><i class="fa fa-check"></i><b>6.4</b> Working with regular expressions</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#anchors-alternates-and-quantifiers"><i class="fa fa-check"></i><b>6.4.1</b> Anchors, alternates, and quantifiers</a></li>
<li class="chapter" data-level="6.4.2" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#look-arounds-and-groups"><i class="fa fa-check"></i><b>6.4.2</b> Look arounds and groups</a></li>
<li class="chapter" data-level="6.4.3" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#match-specific-types-of-characters"><i class="fa fa-check"></i><b>6.4.3</b> Match specific types of characters</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#take-aways-5"><i class="fa fa-check"></i><b>6.5</b> Take-Aways</a></li>
<li class="chapter" data-level="6.6" data-path="tutorial-text-manipulation-with-stringr.html"><a href="tutorial-text-manipulation-with-stringr.html#additional-tutorials-5"><i class="fa fa-check"></i><b>6.6</b> Additional tutorials</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="exercise-5-test-your-knowledge.html"><a href="exercise-5-test-your-knowledge.html"><i class="fa fa-check"></i><b>7</b> Exercise 5: Test your knowledge</a>
<ul>
<li class="chapter" data-level="7.1" data-path="exercise-5-test-your-knowledge.html"><a href="exercise-5-test-your-knowledge.html#task-1-4"><i class="fa fa-check"></i><b>7.1</b> Task 1</a></li>
<li class="chapter" data-level="7.2" data-path="exercise-5-test-your-knowledge.html"><a href="exercise-5-test-your-knowledge.html#task-2-4"><i class="fa fa-check"></i><b>7.2</b> Task 2</a></li>
<li class="chapter" data-level="7.3" data-path="exercise-5-test-your-knowledge.html"><a href="exercise-5-test-your-knowledge.html#task-3-4"><i class="fa fa-check"></i><b>7.3</b> Task 3</a></li>
<li class="chapter" data-level="7.4" data-path="exercise-5-test-your-knowledge.html"><a href="exercise-5-test-your-knowledge.html#task-4-3"><i class="fa fa-check"></i><b>7.4</b> Task 4</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html"><i class="fa fa-check"></i><b>8</b> Tidy text analysis</a>
<ul>
<li class="chapter" data-level="8.1" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#what-is-tidy-text"><i class="fa fa-check"></i><b>8.1</b> What is tidy text?</a></li>
<li class="chapter" data-level="8.2" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#preprocessing-real-world-data"><i class="fa fa-check"></i><b>8.2</b> Preprocessing real-world data</a>
<ul>
<li class="chapter" data-level="8.2.1" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#tokenization"><i class="fa fa-check"></i><b>8.2.1</b> Tokenization</a></li>
<li class="chapter" data-level="" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#practice-tokenization"><i class="fa fa-check"></i>Practice: Tokenization</a></li>
<li class="chapter" data-level="8.2.2" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#stop-word-removal"><i class="fa fa-check"></i><b>8.2.2</b> Stop word removal</a></li>
<li class="chapter" data-level="" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#practice-stop-word-removal"><i class="fa fa-check"></i>Practice: Stop word removal</a></li>
<li class="chapter" data-level="8.2.3" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#lemmatizing-stemming"><i class="fa fa-check"></i><b>8.2.3</b> Lemmatizing &amp; stemming</a></li>
<li class="chapter" data-level="" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#practice-lemmatizing-stemming"><i class="fa fa-check"></i>Practice: Lemmatizing &amp; stemming</a></li>
<li class="chapter" data-level="8.2.4" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#pruning"><i class="fa fa-check"></i><b>8.2.4</b> Pruning</a></li>
<li class="chapter" data-level="" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#practice-pruning"><i class="fa fa-check"></i>Practice: Pruning</a></li>
</ul></li>
<li class="chapter" data-level="8.3" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#topic-modeling"><i class="fa fa-check"></i><b>8.3</b> Topic modeling</a>
<ul>
<li class="chapter" data-level="8.3.1" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#first-steps-create-a-sparse-matrix"><i class="fa fa-check"></i><b>8.3.1</b> First steps: Create a sparse matrix</a></li>
<li class="chapter" data-level="8.3.2" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#first-steps-create-a-date-covariate"><i class="fa fa-check"></i><b>8.3.2</b> First steps: Create a date covariate</a></li>
<li class="chapter" data-level="8.3.3" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#model-estimation-number-of-topics"><i class="fa fa-check"></i><b>8.3.3</b> Model estimation: Number of topics</a></li>
<li class="chapter" data-level="" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#practice-model-estimation"><i class="fa fa-check"></i>Practice: Model estimation</a></li>
<li class="chapter" data-level="8.3.4" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#inspect-the-topics"><i class="fa fa-check"></i><b>8.3.4</b> Inspect the topics</a></li>
<li class="chapter" data-level="" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#practice-inspect-models"><i class="fa fa-check"></i>Practice: Inspect models</a></li>
<li class="chapter" data-level="8.3.5" data-path="tidy-text-analysis.html"><a href="tidy-text-analysis.html#find-the-best-value-for-k"><i class="fa fa-check"></i><b>8.3.5</b> Find the best value for K</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html"><i class="fa fa-check"></i>Solutions</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutions-for-exercise-1"><i class="fa fa-check"></i>Solutions for Exercise 1</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-1-5"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-2-5"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-3-5"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-4-4"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-5-3"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-6-3"><i class="fa fa-check"></i>Task 6</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutions-for-exercise-2"><i class="fa fa-check"></i>Solutions for Exercise 2</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-1-6"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-2-6"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-3-6"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-4-5"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-5-4"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-6-4"><i class="fa fa-check"></i>Task 6</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-7-2"><i class="fa fa-check"></i>Task 7</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutions-for-exercise-3"><i class="fa fa-check"></i>Solutions for Exercise 3</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-1-7"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-2-7"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-3-7"><i class="fa fa-check"></i>Task 3</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutions-for-exercise-4"><i class="fa fa-check"></i>Solutions for Exercise 4</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-1-8"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-2-8"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-3-8"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-4-6"><i class="fa fa-check"></i>Task 4</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-5-5"><i class="fa fa-check"></i>Task 5</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-6-5"><i class="fa fa-check"></i>Task 6</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-7-3"><i class="fa fa-check"></i>Task 7</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-8-1"><i class="fa fa-check"></i>Task 8</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutions-for-exercise-5"><i class="fa fa-check"></i>Solutions for Exercise 5</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-1-9"><i class="fa fa-check"></i>Task 1</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-2-9"><i class="fa fa-check"></i>Task 2</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-3-9"><i class="fa fa-check"></i>Task 3</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-4-7"><i class="fa fa-check"></i>Task 4</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#solutions-for-exercise-6"><i class="fa fa-check"></i>Solutions for Exercise 6</a>
<ul>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-1-tokenization"><i class="fa fa-check"></i>Task 1: Tokenization</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-2-stop-word-removal"><i class="fa fa-check"></i>Task 2: Stop word removal</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-3-lemmatizing-stemming"><i class="fa fa-check"></i>Task 3: Lemmatizing &amp; stemming</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-4-pruning"><i class="fa fa-check"></i>Task 4: Pruning</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-5-model-estimation"><i class="fa fa-check"></i>Task 5: Model estimation</a></li>
<li class="chapter" data-level="" data-path="solutions.html"><a href="solutions.html#task-6-inspect-models"><i class="fa fa-check"></i>Task 6: Inspect models</a></li>
</ul></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/LKobilke/data-journalism" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Data journalism</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="tidy-text-analysis" class="section level1 hasAnchor" number="8">
<h1><span class="header-section-number"> 8</span> Tidy text analysis<a href="tidy-text-analysis.html#tidy-text-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>After working through Tutorial 7, you’ll…</p>
<ul>
<li>understand the concept of tidy text</li>
<li>know how to combine tidy text management approaches with regular
expressions</li>
<li>be able to produce first analyses, e.g., word frequencies</li>
</ul>
<div id="what-is-tidy-text" class="section level2 hasAnchor" number="8.1">
<h2><span class="header-section-number">8.1</span> What is tidy text?<a href="tidy-text-analysis.html#what-is-tidy-text" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Since you’ve already learnt what tidy data is (see <a href="tutorial-data-management-with-tidyverse.html#tidy-data">Tidy data</a>), you can
make an educated guess about the meaning of “tidy text”! In contrast to
the ways text is commonly stored in existing text analysis approaches
(e.g., as strings or document-term matrices), <strong><em>the tidy text format is
a table with one single token per row</em></strong> (token = the unit of analysis).
A token is a meaningful unit of text, i.e., a word, a sentence, or a
paragraph that we are interested in using for further analysis.
Splitting text into tokens is what we call the process of
<em>tokenization</em>.</p>
<p>Julia Silge and David Robinson’s <a href="https://cran.r-project.org/web/packages/tidytext/vignettes/tidytext.html">tidytext
package</a>
makes tokenizing into the tidy text format simple! Moreover, the
<code>tidytext</code> package builds upon <code>tidyverse</code> and <code>ggplot2</code>, which makes it
easy to use for you, since you already know these packages (see
<a href="tutorial-data-management-with-tidyverse.html#tutorial-data-management-with-tidyverse">Tutorial: Data management with tidyverse</a> and <a href="tutorial-data-visualization-with-ggplot.html#tutorial-data-visualization-with-ggplot">Tutorial: Data
visualization with ggplot</a> for a recap). That’s why we’ll focus on the
<code>tidytext</code> in this session.</p>
<p>This tutorial is based on Julia Silge and David Robinson’s open-access
book <a href="https://www.tidytextmining.com/">“Text Mining in R. A Tidy
Approach”</a> and a lot of the following
code was actually written by Julia Silge. If you want to dig deeper into
tidy text analysis, you should check the book out. Both authors have
also created an informative flowchart of the tidy text analysis
workflow:</p>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td align="left"><em>Image: Tidy Text Analysis Workflow</em></td>
</tr>
<tr class="even">
<td align="left"><img src="images/Tut_tidytext_principles.JPG" /></td>
</tr>
</tbody>
</table>
<p>Before we start, install and load the <code>tidytext</code> package and the
<code>tidyverse</code> package.</p>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="tidy-text-analysis.html#cb239-1" aria-hidden="true" tabindex="-1"></a><span class="co"># installing/loading the package:</span></span>
<span id="cb239-2"><a href="tidy-text-analysis.html#cb239-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidytext)) {</span>
<span id="cb239-3"><a href="tidy-text-analysis.html#cb239-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;tidytext&quot;</span>); </span>
<span id="cb239-4"><a href="tidy-text-analysis.html#cb239-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(tidytext)</span>
<span id="cb239-5"><a href="tidy-text-analysis.html#cb239-5" aria-hidden="true" tabindex="-1"></a>} <span class="co">#load / install+load tidytext</span></span>
<span id="cb239-6"><a href="tidy-text-analysis.html#cb239-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb239-7"><a href="tidy-text-analysis.html#cb239-7" aria-hidden="true" tabindex="-1"></a><span class="co"># installing/loading tidyverse:</span></span>
<span id="cb239-8"><a href="tidy-text-analysis.html#cb239-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidyverse)) {</span>
<span id="cb239-9"><a href="tidy-text-analysis.html#cb239-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;tidyverse&quot;</span>); </span>
<span id="cb239-10"><a href="tidy-text-analysis.html#cb239-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(tidyverse)</span>
<span id="cb239-11"><a href="tidy-text-analysis.html#cb239-11" aria-hidden="true" tabindex="-1"></a>} <span class="co">#load / install+load tidyverse</span></span></code></pre></div>
</div>
<div id="preprocessing-real-world-data" class="section level2 hasAnchor" number="8.2">
<h2><span class="header-section-number">8.2</span> Preprocessing real-world data<a href="tidy-text-analysis.html#preprocessing-real-world-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let’s investigate what the <code>tidytext</code> package is capable of and apply it
to some real-world data. I’ve provided you with a data file that
contains data collected with the Twitter API about the Russian
aggression against Ukraine on Moodle.</p>
<p>Let’s import the data into RStudio and inspect it using the <code>View()</code>
function.</p>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="tidy-text-analysis.html#cb240-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">&quot;ukraine_tweets.csv&quot;</span>, <span class="at">encoding =</span> <span class="st">&quot;UTF-8&quot;</span>) <span class="co"># Use UTF-8 encoding to keep the smileys</span></span>
<span id="cb240-2"><a href="tidy-text-analysis.html#cb240-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb240-3"><a href="tidy-text-analysis.html#cb240-3" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data)</span></code></pre></div>
<p>The date column is a character variable. Let’s convert the date column to a standard format using the <code>lubridate</code> package of the <code>tidyverse</code>, making it easier to create graphs using time data later on.</p>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="tidy-text-analysis.html#cb241-1" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb241-2"><a href="tidy-text-analysis.html#cb241-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">time =</span> lubridate<span class="sc">::</span><span class="fu">ymd_hms</span>(time)) <span class="sc">%&gt;%</span>  <span class="co"># turn the data column into a proper format with the lubridate package (this helps to create time series graphs!)</span></span>
<span id="cb241-3"><a href="tidy-text-analysis.html#cb241-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>()</span>
<span id="cb241-4"><a href="tidy-text-analysis.html#cb241-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb241-5"><a href="tidy-text-analysis.html#cb241-5" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data)</span></code></pre></div>
<p>This data set contains a lot of information! We get to know who wrote
the tweet (<em>user</em> and the unique <em>user.id</em>) and where this person lives
(<em>user.location</em>). But most importantly, we can find the text of the
tweet in the column <em>full_text</em>.</p>
<p>First of all, let’s reduce some of these columns that we don’t need for
our text analysis.</p>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="tidy-text-analysis.html#cb242-1" aria-hidden="true" tabindex="-1"></a>data_short <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb242-2"><a href="tidy-text-analysis.html#cb242-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(time, user, full_text) <span class="co"># keeps time, user, and full_text</span></span>
<span id="cb242-3"><a href="tidy-text-analysis.html#cb242-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb242-4"><a href="tidy-text-analysis.html#cb242-4" aria-hidden="true" tabindex="-1"></a><span class="fu">View</span>(data_short)</span></code></pre></div>
<p>Now, to get an overview, let’s create a visualization of the user’s who
posted at least 18 tweets.</p>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="tidy-text-analysis.html#cb243-1" aria-hidden="true" tabindex="-1"></a>data_short <span class="sc">%&gt;%</span></span>
<span id="cb243-2"><a href="tidy-text-analysis.html#cb243-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(user) <span class="sc">%&gt;%</span></span>
<span id="cb243-3"><a href="tidy-text-analysis.html#cb243-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">n =</span> <span class="fu">n</span>()) <span class="sc">%&gt;%</span></span>
<span id="cb243-4"><a href="tidy-text-analysis.html#cb243-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(n <span class="sc">&gt;</span> <span class="dv">18</span>) <span class="sc">%&gt;%</span></span>
<span id="cb243-5"><a href="tidy-text-analysis.html#cb243-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> user, <span class="at">y =</span> n)) <span class="sc">+</span></span>
<span id="cb243-6"><a href="tidy-text-analysis.html#cb243-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">geom =</span> <span class="st">&quot;bar&quot;</span>) <span class="sc">+</span></span>
<span id="cb243-7"><a href="tidy-text-analysis.html#cb243-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb243-8"><a href="tidy-text-analysis.html#cb243-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.00</span>, <span class="at">hjust =</span> <span class="fl">0.00</span>)) <span class="sc">+</span></span>
<span id="cb243-9"><a href="tidy-text-analysis.html#cb243-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">&quot;Users who posted the most tweets about the Russian</span><span class="sc">\n</span><span class="st">aggression against Ukraine&quot;</span>,</span>
<span id="cb243-10"><a href="tidy-text-analysis.html#cb243-10" aria-hidden="true" tabindex="-1"></a>       <span class="at">x =</span> <span class="st">&quot;User name&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Number of Tweets&quot;</span>)</span></code></pre></div>
<p><img src="Data-Journalism_files/figure-html/unnamed-chunk-142-1.png" width="672" /></p>
<p>Now that we have had our overview, we will start with a process called
<em>text normalization</em>. Text normalization is the endeavor to minimize the
variability of a text by bringing it closer to a specified “standard” by
reducing the quantity of divergent data that the computer has to deal
with. In plain English, this means that our goal is to reduce the amount
of text to a small set of words that are especially suitable to explain
similarities and differences between tweets and, more interestingly,
between the accounts that have published these tweets. Overall, text
normalization boosts efficiency. Some techniques of text normalization
will be covered in the next few sections, for example, tokenization,
stop word removal, stemming/lemmatization and pruning. You could add
additional steps, e.g. spelling corrections to reduce misspellings that
increase word variance, but we won’t cover all text normalization steps
in this tutorial.</p>
<div id="tokenization" class="section level3 hasAnchor" number="8.2.1">
<h3><span class="header-section-number">8.2.1</span> Tokenization<a href="tidy-text-analysis.html#tokenization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>I think we are ready to tokenize the data with the amazing
<code>unnest_tokens()</code> function of the <code>tidytext</code> package. <em>Tokenization</em> is
the process of breaking text into words (and punctuation marks). Since
scientists are almost never interested in the punctuation marks and will
delete them from the data set later anyway, <code>unnest_tokens()</code> comes with
the nice bonus of setting all text to lowercase and deleting the
punctuation marks directly, leaving only words (and numbers) as tokens.</p>
<p>A common practice is to remove all tokens that contain numbers.
Depending on the research question, it can also be helpful to remove
URLs. For illustrative purposes, we will do both. But keep in mind that
removing all URLs will take the option from you to compare what accounts
have shared certain URLs more frequently than others.</p>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="tidy-text-analysis.html#cb244-1" aria-hidden="true" tabindex="-1"></a>remove_reg <span class="ot">&lt;-</span> <span class="st">&quot;&amp;amp;|&amp;lt;|&amp;gt;&quot;</span> <span class="co"># &amp;amp; = &amp; in HTML,  &amp;lt; = &lt; in HTML,   &amp;gt; = &gt; in HTML</span></span>
<span id="cb244-2"><a href="tidy-text-analysis.html#cb244-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-3"><a href="tidy-text-analysis.html#cb244-3" aria-hidden="true" tabindex="-1"></a>data_tknzd <span class="ot">&lt;-</span> data_short <span class="sc">%&gt;%</span></span>
<span id="cb244-4"><a href="tidy-text-analysis.html#cb244-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">tweet =</span> <span class="fu">row_number</span>()) <span class="sc">%&gt;%</span> <span class="co"># creates a new column that is called &quot;tweet&quot;, which contains a unique id for each individual tweet based on its row number</span></span>
<span id="cb244-5"><a href="tidy-text-analysis.html#cb244-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(full_text, <span class="st">&quot;^RT&quot;</span>)) <span class="sc">%&gt;%</span>  <span class="co"># removes all retweets, i.e., tweets that are not unique but a reposts</span></span>
<span id="cb244-6"><a href="tidy-text-analysis.html#cb244-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">text =</span> <span class="fu">str_remove_all</span>(full_text, remove_reg)) <span class="sc">%&gt;%</span>  <span class="co"># remove special HTML characters (&amp;, &lt;, &gt;)</span></span>
<span id="cb244-7"><a href="tidy-text-analysis.html#cb244-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest_tokens</span>(word, full_text) <span class="sc">%&gt;%</span></span>
<span id="cb244-8"><a href="tidy-text-analysis.html#cb244-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">&quot;^[:digit:]+$&quot;</span>)) <span class="sc">%&gt;%</span>             <span class="co"># remove all words that are numbers, e.g. &quot;2020&quot;</span></span>
<span id="cb244-9"><a href="tidy-text-analysis.html#cb244-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">&quot;^http&quot;</span>)) <span class="sc">%&gt;%</span>                    <span class="co"># remove all words that are a URL, e.g., (https://evoldyn.gitlab.io/evomics-2018/ref-sheets/R_strings.pdf)</span></span>
<span id="cb244-10"><a href="tidy-text-analysis.html#cb244-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">&quot;^(</span><span class="sc">\\</span><span class="st">+)+$&quot;</span>)) <span class="sc">%&gt;%</span>                 <span class="co">#  remove all words that only consist of plus signs (e.g., &quot;+++&quot;)</span></span>
<span id="cb244-11"><a href="tidy-text-analysis.html#cb244-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">&quot;^(</span><span class="sc">\\</span><span class="st">+)+(.)+$&quot;</span>)) <span class="sc">%&gt;%</span>             <span class="co">#  remove all words that only consist of plus signs followed by any other characters (e.g., &quot;+++eil+++&quot;)</span></span>
<span id="cb244-12"><a href="tidy-text-analysis.html#cb244-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">&quot;^(</span><span class="sc">\\</span><span class="st">-)+$&quot;</span>)) <span class="sc">%&gt;%</span>                 <span class="co">#  remove all words that only consist of plus signs (e.g., &quot;---&quot;)</span></span>
<span id="cb244-13"><a href="tidy-text-analysis.html#cb244-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">&quot;^(</span><span class="sc">\\</span><span class="st">-)+(.)+$&quot;</span>)) <span class="sc">%&gt;%</span>             <span class="co">#  remove all words that only consist of minus signs followed by any other characters (e.g., &quot;---eil---&quot;)</span></span>
<span id="cb244-14"><a href="tidy-text-analysis.html#cb244-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">str_detect</span>(word, <span class="st">&quot;^(.)+(</span><span class="sc">\\</span><span class="st">+)+$&quot;</span>))                 <span class="co"># remove all words that start with some kind of word followed by plus signs (e.g., &quot;news+++&quot;)</span></span>
<span id="cb244-15"><a href="tidy-text-analysis.html#cb244-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb244-16"><a href="tidy-text-analysis.html#cb244-16" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_tknzd)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   time                user     tweet text                                  word 
##   &lt;dttm&gt;              &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;                                 &lt;chr&gt;
## 1 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… vond…
## 2 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… eu_c…
## 3 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… rubb…
## 4 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… your 
## 5 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… words
## 6 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… and</code></pre>
<p>Now, let’s check the total number of unique words in our tweet data:</p>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="tidy-text-analysis.html#cb246-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;We are investigating &quot;</span>, <span class="fu">dim</span>(data_tknzd)[<span class="dv">1</span>], <span class="st">&quot; non-unique features / words and &quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(data_tknzd<span class="sc">$</span>word)), <span class="st">&quot; unique features / words.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;We are investigating  259873  non-unique features / words and  25922  unique features / words.&quot;</code></pre>
<p><strong>Remember:</strong> <code>unnest tokens()</code> comes with a few handy preprocessing
features, i.e., it already turns the text into a standardized format for
further analysis:</p>
<ol style="list-style-type: decimal">
<li>Tweet ids from which each word originated are kept in the data frame
(column: <em>tweet</em>).</li>
<li>All punctuation has already been taken care of, i.e., dots,
questions marks, etc. have been removed.</li>
<li>All uppercase letters have been taken care of, i.e., words have been
transformed to lowercase.<a href="#fn4" class="footnote-ref" id="fnref4"><sup>4</sup></a></li>
</ol>
</div>
<div id="practice-tokenization" class="section level3 unnumbered hasAnchor">
<h3>Practice: Tokenization<a href="tidy-text-analysis.html#practice-tokenization" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now it’s your turn. I’ve added another data set to Moodle that deals
with the shitstorm about the German influencer <em>Fynn Kliemann</em> on
Twitter. You can read more about the scandal that started on the 6th of
May 2022
<a href="https://www.augsburger-allgemeine.de/panorama/fynn-kliemann-ist-seine-karriere-nach-masken-skandal-vorbei-id62699096.html">here</a>
if you feel that you need more information.</p>
<p>Load the Kliemann data into RStudio. Use the tutorial code and to set
the encoding and to convert the date column to a standardized date format. After loading the Kliemann data keep only the <em>time</em>, <em>user</em>, and <em>full_text</em> column.</p>
<p>Next, try to tokenize the data.</p>
<p>For solutions see: <a href="solutions.html#solutions-for-exercise-6">Solutions for Exercise 6</a></p>
</div>
<div id="stop-word-removal" class="section level3 hasAnchor" number="8.2.2">
<h3><span class="header-section-number">8.2.2</span> Stop word removal<a href="tidy-text-analysis.html#stop-word-removal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we should get rid of stop words. Stop words are a group of words
that are regularly used in a language. In English, stop words such as
“the,” “is,” and “and” would qualify. Because stop words are so common,
they don’t really tell us anything about the content of a tweet and what
differentiates this tweet from other tweets. The <code>tidytext</code> package
comes with a pre-installed stop word data set. Let’s save that data set
to a source object called <em>stop_word_data</em>. This way, we can use it
later.</p>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="tidy-text-analysis.html#cb248-1" aria-hidden="true" tabindex="-1"></a>stop_word_data <span class="ot">&lt;-</span> tidytext<span class="sc">::</span>stop_words</span>
<span id="cb248-2"><a href="tidy-text-analysis.html#cb248-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb248-3"><a href="tidy-text-analysis.html#cb248-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(stop_word_data, <span class="dv">20</span>) <span class="co"># prints the first 20 stop words to the console</span></span></code></pre></div>
<pre><code>## # A tibble: 20 × 2
##    word        lexicon
##    &lt;chr&gt;       &lt;chr&gt;  
##  1 a           SMART  
##  2 a&#39;s         SMART  
##  3 able        SMART  
##  4 about       SMART  
##  5 above       SMART  
##  6 according   SMART  
##  7 accordingly SMART  
##  8 across      SMART  
##  9 actually    SMART  
## 10 after       SMART  
## 11 afterwards  SMART  
## 12 again       SMART  
## 13 against     SMART  
## 14 ain&#39;t       SMART  
## 15 all         SMART  
## 16 allow       SMART  
## 17 allows      SMART  
## 18 almost      SMART  
## 19 alone       SMART  
## 20 along       SMART</code></pre>
<p>Now, let’s use these stop words to remove all tokens that are stop words
from our tweet data.</p>
<div class="sourceCode" id="cb250"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb250-1"><a href="tidy-text-analysis.html#cb250-1" aria-hidden="true" tabindex="-1"></a>data_tknzd <span class="ot">&lt;-</span> data_tknzd <span class="sc">%&gt;%</span> </span>
<span id="cb250-2"><a href="tidy-text-analysis.html#cb250-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> stop_word_data<span class="sc">$</span>word) <span class="sc">%&gt;%</span>  <span class="co"># removes all of our tokens that are stop words</span></span>
<span id="cb250-3"><a href="tidy-text-analysis.html#cb250-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span>word <span class="sc">%in%</span> <span class="fu">str_remove_all</span>(stop_word_data<span class="sc">$</span>word, <span class="st">&quot;&#39;&quot;</span>)) <span class="co"># first removes all &#39; from the stop words (e.g., ain&#39;t -&gt; aint) and then removes all of our tokens that resemble these stop words without punctuation</span></span></code></pre></div>
</div>
<div id="practice-stop-word-removal" class="section level3 unnumbered hasAnchor">
<h3>Practice: Stop word removal<a href="tidy-text-analysis.html#practice-stop-word-removal" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now it’s your turn. The Kliemann data is in German, so you can’t use the
<code>tidytext</code> stop word list, which is meant for English text only. So
install and load the ‘stopwords’ package that allows you to create a
dataframe that contains German stop words by using this command:
<code>stop_word_german &lt;- data.frame(word = stopwords::stopwords("de"), stringsAsFactors = FALSE)</code>.
Create your German stop word list and use it to remove stop words from
your tokens.</p>
<p>For solutions see: <a href="solutions.html#solutions-for-exercise-6">Solutions for Exercise 6</a></p>
</div>
<div id="lemmatizing-stemming" class="section level3 hasAnchor" number="8.2.3">
<h3><span class="header-section-number">8.2.3</span> Lemmatizing &amp; stemming<a href="tidy-text-analysis.html#lemmatizing-stemming" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Minimizing words to their basic form (<em>lemmatizing</em>) or root
(<em>stemming</em>) is a typical strategy of reducing the number of words in a
text.</p>
<ol style="list-style-type: decimal">
<li><p><strong>Stemming:</strong> A stem is the root form of a word without any
suffixes. A stemming algorithm (= <em>stemmer</em>) removes the suffixes
and returns the stem of the word. <em>Example1:</em> vengeance –&gt;
vengeanc, or, if you use a very aggressive stemmer, vengeance –&gt;
veng || <em>Example2</em>: legions –&gt; legion, or, if you use a very
aggressive stemmer, legions –&gt; leg (this one is problematic!) ||
<em>Example3</em>: murdered –&gt; murder</p></li>
<li><p><strong>Lemmatization:</strong> A lemma is a lexicon headword or, i.e., the
dictionary-matched basic form of a word (as opposed to a stem
created by eliminating or changing suffixes). Because a lemmatizing
algorithm (= <em>lemmatizer</em>) performs dictionary matching,
lemmatization is more computationally demanding than stemming.
vengeance –&gt; vengeance || <em>Example2</em>: legions –&gt; legion ||
<em>Example3</em>: murdered –&gt; murdered (this one is problematic!)</p></li>
</ol>
<p>Most of the time, stemmers will make a lot of mistakes (e.g., legions
–&gt; leg) and lemmatizers will make fewer mistakes. However, lemmatizers
summarize fewer words (murdered –&gt; murdered) and therefore reduce the
word count less efficiently than stemmers. Which technique of text
normalization is preferred is always determined by the research question
and the available data.</p>
<p>For the ease of teaching, we will use stemming on our tweet data.
However, you could also use lemmatization with the <a href="https://spacyr.quanteda.io/">spacyr
package</a>.</p>
<p>We’ll use Porter’s (1980) stemming algorthm, which is the most
extensively used stemmer for the English language. Porter made the
stemmer open-source, and you may use it with R using the <code>SnowballC</code>
package (Bouchet-Valat 2020).</p>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="tidy-text-analysis.html#cb251-1" aria-hidden="true" tabindex="-1"></a><span class="co"># installing/loading SnowballC:</span></span>
<span id="cb251-2"><a href="tidy-text-analysis.html#cb251-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(SnowballC)) {</span>
<span id="cb251-3"><a href="tidy-text-analysis.html#cb251-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;SnowballC&quot;</span>); </span>
<span id="cb251-4"><a href="tidy-text-analysis.html#cb251-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(SnowballC)</span>
<span id="cb251-5"><a href="tidy-text-analysis.html#cb251-5" aria-hidden="true" tabindex="-1"></a>} <span class="co">#load / install+load SnowballC</span></span>
<span id="cb251-6"><a href="tidy-text-analysis.html#cb251-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-7"><a href="tidy-text-analysis.html#cb251-7" aria-hidden="true" tabindex="-1"></a>data_tknzd <span class="ot">&lt;-</span> data_tknzd <span class="sc">%&gt;%</span></span>
<span id="cb251-8"><a href="tidy-text-analysis.html#cb251-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">word =</span> <span class="fu">wordStem</span>(word))</span>
<span id="cb251-9"><a href="tidy-text-analysis.html#cb251-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb251-10"><a href="tidy-text-analysis.html#cb251-10" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_tknzd)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 5
##   time                user     tweet text                                  word 
##   &lt;dttm&gt;              &lt;chr&gt;    &lt;int&gt; &lt;chr&gt;                                 &lt;chr&gt;
## 1 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… vond…
## 2 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… eu_c…
## 3 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… rubb…
## 4 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… word 
## 5 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… fell…
## 6 2022-02-25 18:10:59 peekay14     1 @vonderleyen @EU_Commission rubbish!… eu</code></pre>
<p>Let’s check how many unique words we have in our tweet data after all of
our preprocessing efforts:</p>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="tidy-text-analysis.html#cb253-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;We are investigating &quot;</span>, <span class="fu">dim</span>(data_tknzd)[<span class="dv">1</span>], <span class="st">&quot; non-unique features / words and &quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(data_tknzd<span class="sc">$</span>word)), <span class="st">&quot; unique features / words.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;We are investigating  130045  non-unique features / words and  21188  unique features / words.&quot;</code></pre>
</div>
<div id="practice-lemmatizing-stemming" class="section level3 unnumbered hasAnchor">
<h3>Practice: Lemmatizing &amp; stemming<a href="tidy-text-analysis.html#practice-lemmatizing-stemming" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Please stem the Kliemann data with the PorterStemmer. Since we are
working with German data, you’ll have to add the option
<code>language = "german"</code> to the <code>wordStem()</code> function.</p>
<p>For solutions see: <a href="solutions.html#solutions-for-exercise-6">Solutions for Exercise 6</a></p>
</div>
<div id="pruning" class="section level3 hasAnchor" number="8.2.4">
<h3><span class="header-section-number">8.2.4</span> Pruning<a href="tidy-text-analysis.html#pruning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Finally, words that appear in practically every tweet (i.e., promiscuous
words) or words that that appear only once or twice in the entire data
set (i.e., rare words) are not very helpful for investigating the
“typical” word use of certain Twitter accounts. Since these words do not
contribute to capturing similarities and differences in texts, it is a
good idea to remove them. This process of <em>(relative) pruning</em> is
quickly achieved with the <code>quanteda</code> package. Since I don’t want to
teach you how to use <code>quanteda</code> just yet, I have developed a useful
short cut function that enables you to use relative pruning without
having to learn <code>quanteda</code> functions.</p>
<p>First, install/load the <code>quanteda</code> package and initialize my
<code>prune</code>-function by running this code:</p>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="tidy-text-analysis.html#cb255-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install / load the quanteda package</span></span>
<span id="cb255-2"><a href="tidy-text-analysis.html#cb255-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(quanteda)) {</span>
<span id="cb255-3"><a href="tidy-text-analysis.html#cb255-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;quanteda&quot;</span>); </span>
<span id="cb255-4"><a href="tidy-text-analysis.html#cb255-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(quanteda)</span>
<span id="cb255-5"><a href="tidy-text-analysis.html#cb255-5" aria-hidden="true" tabindex="-1"></a>} <span class="co">#load / install+load quanteda</span></span>
<span id="cb255-6"><a href="tidy-text-analysis.html#cb255-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-7"><a href="tidy-text-analysis.html#cb255-7" aria-hidden="true" tabindex="-1"></a>prune <span class="ot">&lt;-</span> <span class="cf">function</span>(data, tweet_column, word_column, text_column, user_column, minDocFreq, maxDocFreq) {</span>
<span id="cb255-8"><a href="tidy-text-analysis.html#cb255-8" aria-hidden="true" tabindex="-1"></a><span class="fu">suppressWarnings</span>(<span class="fu">suppressMessages</span>(<span class="fu">library</span>(<span class="st">&quot;quanteda&quot;</span>, <span class="at">quietly =</span> T)))</span>
<span id="cb255-9"><a href="tidy-text-analysis.html#cb255-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Grab the variable names for later use</span></span>
<span id="cb255-10"><a href="tidy-text-analysis.html#cb255-10" aria-hidden="true" tabindex="-1"></a>tweet_name <span class="ot">&lt;-</span> <span class="fu">substitute</span>(tweet_column)</span>
<span id="cb255-11"><a href="tidy-text-analysis.html#cb255-11" aria-hidden="true" tabindex="-1"></a>word_name <span class="ot">&lt;-</span> <span class="fu">substitute</span>(word_column)</span>
<span id="cb255-12"><a href="tidy-text-analysis.html#cb255-12" aria-hidden="true" tabindex="-1"></a>tweet_name_chr <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">substitute</span>(tweet_column))</span>
<span id="cb255-13"><a href="tidy-text-analysis.html#cb255-13" aria-hidden="true" tabindex="-1"></a>word_name_chr <span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">substitute</span>(word_column))</span>
<span id="cb255-14"><a href="tidy-text-analysis.html#cb255-14" aria-hidden="true" tabindex="-1"></a><span class="co"># turn the tidy data frame into a document-feature matrix:</span></span>
<span id="cb255-15"><a href="tidy-text-analysis.html#cb255-15" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span></span>
<span id="cb255-16"><a href="tidy-text-analysis.html#cb255-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>({{tweet_column}}, {{text_column}}, {{word_column}}, {{user_column}}) <span class="sc">%&gt;%</span></span>
<span id="cb255-17"><a href="tidy-text-analysis.html#cb255-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>({{tweet_column}}, {{word_column}}, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb255-18"><a href="tidy-text-analysis.html#cb255-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_dfm</span>({{tweet_column}}, {{word_column}}, n)</span>
<span id="cb255-19"><a href="tidy-text-analysis.html#cb255-19" aria-hidden="true" tabindex="-1"></a><span class="co"># perform relative pruning:</span></span>
<span id="cb255-20"><a href="tidy-text-analysis.html#cb255-20" aria-hidden="true" tabindex="-1"></a>dfm <span class="ot">&lt;-</span> <span class="fu">dfm_trim</span>(dfm, </span>
<span id="cb255-21"><a href="tidy-text-analysis.html#cb255-21" aria-hidden="true" tabindex="-1"></a>                <span class="at">min_docfreq =</span> minDocFreq, <span class="co"># remove all words that occur in less than minDocFreq% of all tweets</span></span>
<span id="cb255-22"><a href="tidy-text-analysis.html#cb255-22" aria-hidden="true" tabindex="-1"></a>                <span class="at">max_docfreq =</span> maxDocFreq, <span class="co"># remove all words that occur in more than maxDocFreq% of all tweets</span></span>
<span id="cb255-23"><a href="tidy-text-analysis.html#cb255-23" aria-hidden="true" tabindex="-1"></a>                <span class="at">docfreq_type =</span> <span class="st">&quot;prop&quot;</span>,    <span class="co"># use probabilities</span></span>
<span id="cb255-24"><a href="tidy-text-analysis.html#cb255-24" aria-hidden="true" tabindex="-1"></a>                <span class="at">verbose =</span> <span class="cn">FALSE</span>)          <span class="co"># don&#39;t tell us what you have achieved with relative pruning</span></span>
<span id="cb255-25"><a href="tidy-text-analysis.html#cb255-25" aria-hidden="true" tabindex="-1"></a><span class="co"># turn the document-feature-matrix back into a tidy data frame:</span></span>
<span id="cb255-26"><a href="tidy-text-analysis.html#cb255-26" aria-hidden="true" tabindex="-1"></a>data2 <span class="ot">&lt;-</span> <span class="fu">tidy</span>(dfm) <span class="sc">%&gt;%</span> </span>
<span id="cb255-27"><a href="tidy-text-analysis.html#cb255-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>({{word_name}} <span class="sc">:</span><span class="er">=</span> term) <span class="sc">%&gt;%</span> <span class="co"># rename columns so that their names from data_tknzd and data_tknzd2 match</span></span>
<span id="cb255-28"><a href="tidy-text-analysis.html#cb255-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>({{tweet_name}} <span class="sc">:</span><span class="er">=</span> document) <span class="sc">%&gt;%</span></span>
<span id="cb255-29"><a href="tidy-text-analysis.html#cb255-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="sc">-</span>count) <span class="sc">%&gt;%</span> <span class="co"># remove the count column</span></span>
<span id="cb255-30"><a href="tidy-text-analysis.html#cb255-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>({{tweet_name}} <span class="sc">:</span><span class="er">=</span>  <span class="fu">as.integer</span>({{tweet_name}}))</span>
<span id="cb255-31"><a href="tidy-text-analysis.html#cb255-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb255-32"><a href="tidy-text-analysis.html#cb255-32" aria-hidden="true" tabindex="-1"></a><span class="co"># delete the words that quanteda suggested from the original data</span></span>
<span id="cb255-33"><a href="tidy-text-analysis.html#cb255-33" aria-hidden="true" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">right_join</span>(data, data2, <span class="at">by =</span> <span class="fu">c</span>(word_name_chr,tweet_name_chr)) <span class="sc">%&gt;%</span> <span class="co"># keep only the shorter data set without frequent/rare words, but fill in all other columns like user and date</span></span>
<span id="cb255-34"><a href="tidy-text-analysis.html#cb255-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>({{tweet_name}},{{word_name}}, <span class="at">.keep_all=</span> <span class="cn">TRUE</span>) <span class="co"># remove duplicate rows that have been created during the merging process</span></span>
<span id="cb255-35"><a href="tidy-text-analysis.html#cb255-35" aria-hidden="true" tabindex="-1"></a><span class="fu">return</span>(data)</span>
<span id="cb255-36"><a href="tidy-text-analysis.html#cb255-36" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p>Now that you have my <code>prune()</code> function running, you can use it to prune
your data. The prune function takes the following arguments:</p>
<ol style="list-style-type: decimal">
<li><strong>data:</strong> the name of your data set (here: <em>data_tknzd</em>),</li>
<li><strong>tweet_column:</strong> the name of the column that contains the tweet ids
(here: <em>tweet</em>)</li>
<li><strong>word_column</strong>: the name of the column that contains the
words/tokens (here: <em>word</em>), the name of the column that contains
the full text of the tweets (here: <em>text</em>)</li>
<li><strong>text_column:</strong> the name of the column that contains the tweets’
full text (here: <em>text</em>)</li>
<li><strong>user_column</strong>: the name of the column that contains the user names
(here: <em>user</em>)</li>
<li><strong>minDocFreq</strong>: the minimum values of a word’s occurrence in tweets,
below which super rare words will be removed (e.g., occurs in less
than 0.01% of all tweets, we choose here: <em>0.001</em>)</li>
<li><strong>maxDocFreq</strong>: the maximum values of a word’s occurrence in tweets,
above which super promiscuous words will be removed (e.g., occurs in
more than 95% of all tweets, we choose here: <em>0.95</em>)</li>
</ol>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="tidy-text-analysis.html#cb256-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install / load the quanteda package for topic modeling</span></span>
<span id="cb256-2"><a href="tidy-text-analysis.html#cb256-2" aria-hidden="true" tabindex="-1"></a>data_tknzd <span class="ot">&lt;-</span> <span class="fu">prune</span>(data_tknzd,tweet,word,text,user, <span class="fl">0.001</span>, <span class="fl">0.95</span>)</span></code></pre></div>
<p>Finally, now that we have removed very rare and very frequent words,
let’s check the number of our unique words again:</p>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="tidy-text-analysis.html#cb257-1" aria-hidden="true" tabindex="-1"></a><span class="fu">paste</span>(<span class="st">&quot;We are investigating &quot;</span>, <span class="fu">dim</span>(data_tknzd)[<span class="dv">1</span>], <span class="st">&quot; non-unique features / words and &quot;</span>, <span class="fu">length</span>(<span class="fu">unique</span>(data_tknzd<span class="sc">$</span>word)), <span class="st">&quot; unique features / words.&quot;</span>)</span></code></pre></div>
<pre><code>## [1] &quot;We are investigating  90806  non-unique features / words and  1762  unique features / words.&quot;</code></pre>
<p>Great, we have finished the text normalization process! I think we are
ready to take a sneak peek at our most common words! What are the 10
most commonly used words in our tweet data? I’m excited!</p>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="tidy-text-analysis.html#cb259-1" aria-hidden="true" tabindex="-1"></a>data_tknzd <span class="sc">%&gt;%</span></span>
<span id="cb259-2"><a href="tidy-text-analysis.html#cb259-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(word, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span></span>
<span id="cb259-3"><a href="tidy-text-analysis.html#cb259-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">slice_head</span>(<span class="at">n=</span><span class="dv">10</span>)</span></code></pre></div>
<pre><code>## # A tibble: 10 × 2
##    word        n
##    &lt;chr&gt;   &lt;int&gt;
##  1 ukrain   8873
##  2 t.co     4110
##  3 russia   2419
##  4 putin    1453
##  5 russian  1320
##  6 war      1136
##  7 peopl    1111
##  8 nato     1048
##  9 invas     706
## 10 countri   644</code></pre>
<p><strong>Evaluation:</strong> Shortly after Russia’s invasion of Ukraine began,
Twitter conversations centered on the countries Ukraine, Russia, Putin,
the people, the war, NATO, and the invasion.</p>
</div>
<div id="practice-pruning" class="section level3 unnumbered hasAnchor">
<h3>Practice: Pruning<a href="tidy-text-analysis.html#practice-pruning" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Please, try the <code>prune</code> function for yourself. Prune the Kliemann data
and remove 1) words that occur in less than 0.03% of all tweets and 2)
words that occur in more than 95% of all tweets. <strong>Beware:</strong> Pruning is
a demanding task, therefore your machine might need a while to complete
the computations. Wait until the red stop sign in your console vanishes.</p>
<p>For solutions see: <a href="solutions.html#solutions-for-exercise-6">Solutions for Exercise 6</a></p>
</div>
</div>
<div id="topic-modeling" class="section level2 hasAnchor" number="8.3">
<h2><span class="header-section-number">8.3</span> Topic modeling<a href="tidy-text-analysis.html#topic-modeling" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now that we have finished our text normalization process, let’s get some results!</p>
<p>In this section, we’ll use a combination of the <code>tidytext</code> package and the <code>stm</code> package to create topic models with <em>Latent Dirichlet allocation</em> (<em>LDA</em>), one of the most prevalent
topic modeling algorithms. LDA creates <em>mixed-membership models</em>, i.e.,
LDA assumes that every text contains a mix of different topics, e.g. a
tweet can be 60% about TopicA (War crimes) and 40% about TopicB (Housing
of refugees). Topics are defined by the mix of words that are associated
with them. For example, the most common words in TopicA (War crimes) can
be “massacre”, “soldiers”, and “brutal”. The most common words in TopicB
(Housing of refugees) can be “volunteers”, “shelter”, and “children”.
However, both topics can be mentioned in one single text, e.g., tweets
about the brutal war crimes of Russian soldiers that force Ukrainian
refugees to take their children and seek shelter in neighboring
countries. LDA estimates the most common words in a topic and the most
common topics in a text simultaneously.</p>
<table>
<colgroup>
<col width="100%" />
</colgroup>
<tbody>
<tr class="odd">
<td><em>Image: Assigning topics to a document (<a href="https://sicss.io/2019/materials/day3-text-analysis/topic-modeling/rmarkdown/Topic_Modeling.html">Screenshot from: Chris Bail)</a>:</em></td>
</tr>
<tr class="even">
<td><img src="images/Tut_topic_modeling.JPG" /></td>
</tr>
</tbody>
</table>
<p><strong>Important hint:</strong> The <code>stm</code> package uses machine learning lingo. That is, words are called <em>features</em> and texts/tweets are called <em>documents</em>. The total sum of all documents is
called a <em>corpus</em>. In the long run, you should get used to this lingo, so we will keep using it in this tutorial, too.</p>
<div id="first-steps-create-a-sparse-matrix" class="section level3 hasAnchor" number="8.3.1">
<h3><span class="header-section-number">8.3.1</span> First steps: Create a sparse matrix<a href="tidy-text-analysis.html#first-steps-create-a-sparse-matrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>If you haven’t already, please install <code>stm</code> and <code>tidytext</code> packages:</p>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="tidy-text-analysis.html#cb261-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install / load the stm package for topic modeling</span></span>
<span id="cb261-2"><a href="tidy-text-analysis.html#cb261-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(stm)) {</span>
<span id="cb261-3"><a href="tidy-text-analysis.html#cb261-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;stm&quot;</span>); </span>
<span id="cb261-4"><a href="tidy-text-analysis.html#cb261-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(stm)</span>
<span id="cb261-5"><a href="tidy-text-analysis.html#cb261-5" aria-hidden="true" tabindex="-1"></a>} <span class="co">#load / install+load stm</span></span>
<span id="cb261-6"><a href="tidy-text-analysis.html#cb261-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb261-7"><a href="tidy-text-analysis.html#cb261-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Install / load the tidytext package for topic modeling</span></span>
<span id="cb261-8"><a href="tidy-text-analysis.html#cb261-8" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(tidytext)) {</span>
<span id="cb261-9"><a href="tidy-text-analysis.html#cb261-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;tidytext&quot;</span>); </span>
<span id="cb261-10"><a href="tidy-text-analysis.html#cb261-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(tidytext)</span>
<span id="cb261-11"><a href="tidy-text-analysis.html#cb261-11" aria-hidden="true" tabindex="-1"></a>} <span class="co">#load / install+load tidytext</span></span></code></pre></div>
<p>First, using the <code>tidytext</code> package, we will convert our tidy text data
into a sparse matrix that the <code>stm</code> package can understand for its LDA algorithm and do calculations with. For this we reshape our tokenized data into a new format called sparse matrix. In a sparse matrix…</p>
<ol style="list-style-type: decimal">
<li>…rows represent the documents (= texts),</li>
<li>…columns represent features (= unique words),</li>
<li>…the cells represent whether this word is present (<em>1</em>) or not present (<em>.</em>) in this document.</li>
</ol>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="tidy-text-analysis.html#cb262-1" aria-hidden="true" tabindex="-1"></a>data_sparse <span class="ot">&lt;-</span> data_tknzd <span class="sc">%&gt;%</span></span>
<span id="cb262-2"><a href="tidy-text-analysis.html#cb262-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tweet, text, word) <span class="sc">%&gt;%</span></span>
<span id="cb262-3"><a href="tidy-text-analysis.html#cb262-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">count</span>(tweet, word, <span class="at">sort =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> </span>
<span id="cb262-4"><a href="tidy-text-analysis.html#cb262-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">cast_sparse</span>(tweet, word, n)</span>
<span id="cb262-5"><a href="tidy-text-analysis.html#cb262-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb262-6"><a href="tidy-text-analysis.html#cb262-6" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(data_sparse)</span></code></pre></div>
<pre><code>## 6 x 1762 sparse Matrix of class &quot;dgCMatrix&quot;
##                                                                               
## 1  1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . 1 . . . 1 1 1 1 . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . 1 . . . . . . . 1 1 . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . 1 1 . . . . . . . . . 1 1 1 1 . . . . . . . . .
## 24 . . . . . . . . . . . . . . . 1 . . . . . . 1 . . . . 1 . 1 1 1 1 1 1 1 1 1
## 31 . . . . . . . . . . . . . . . 1 . . . . . 1 1 . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . 1 1 1 1 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                                                                               
## 1  . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .
##                               
## 1  . . . . . . . . . . . . . .
## 11 . . . . . . . . . . . . . .
## 12 . . . . . . . . . . . . . .
## 17 . . . . . . . . . . . . . .
## 24 . . . . . . . . . . . . . .
## 31 . . . . . . . . . . . . . .</code></pre>
<p>As you can infer from the concole output, the first feature / word in the sparse matrix is
“against”. This word is present in the first document / tweet because we can see a <em>1</em> and not a <em>.</em>! The features / words “and” and “ar” are also present in this document / tweet.</p>
</div>
<div id="first-steps-create-a-date-covariate" class="section level3 hasAnchor" number="8.3.2">
<h3><span class="header-section-number">8.3.2</span> First steps: Create a date covariate<a href="tidy-text-analysis.html#first-steps-create-a-date-covariate" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>When we analyze topic models, we usually want to know how the identified topics develop over time. To do this, we have to give the <code>stm</code>-package a time span within which it should model the topics. The following code calculates the time span that you can give to <code>stm</code>later on. Be careful to always adjust the time span to fit your data. You need to change the <code>min()</code> function to the earliest time point that you have in your data.</p>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="tidy-text-analysis.html#cb264-1" aria-hidden="true" tabindex="-1"></a>date_covariate <span class="ot">&lt;-</span> data_tknzd <span class="sc">%&gt;%</span> </span>
<span id="cb264-2"><a href="tidy-text-analysis.html#cb264-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tweet, time) <span class="sc">%&gt;%</span>  <span class="co"># select only the tweet and time column</span></span>
<span id="cb264-3"><a href="tidy-text-analysis.html#cb264-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">distinct</span>(tweet, time, <span class="at">.keep_all =</span> <span class="cn">TRUE</span>) <span class="sc">%&gt;%</span> <span class="co"># check for duplicate tweets and remove them</span></span>
<span id="cb264-4"><a href="tidy-text-analysis.html#cb264-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">days =</span> <span class="fu">as.numeric</span>(<span class="fu">difftime</span>(<span class="at">time1 =</span> time, <span class="at">time2 =</span> <span class="fu">min</span>(<span class="st">&quot;2022-02-25&quot;</span>), <span class="at">units =</span> <span class="st">&quot;days&quot;</span>))) <span class="sc">%&gt;%</span> <span class="co"># calculate the time span between the tweet&#39;s creation date and the least recent time point in our data and save this difference to a variable called &quot;days&quot;. Make it a numeric format, not a date format any more</span></span>
<span id="cb264-5"><a href="tidy-text-analysis.html#cb264-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(tweet, days)</span>
<span id="cb264-6"><a href="tidy-text-analysis.html#cb264-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb264-7"><a href="tidy-text-analysis.html#cb264-7" aria-hidden="true" tabindex="-1"></a><span class="co"># If you want to investigate only full days, you can also run this code,</span></span>
<span id="cb264-8"><a href="tidy-text-analysis.html#cb264-8" aria-hidden="true" tabindex="-1"></a><span class="co"># but since our data only covers one day, we want to investigate hours, minutes and seconds:</span></span>
<span id="cb264-9"><a href="tidy-text-analysis.html#cb264-9" aria-hidden="true" tabindex="-1"></a><span class="co">#  date_covariate &lt;- date_covariate %&gt;%</span></span>
<span id="cb264-10"><a href="tidy-text-analysis.html#cb264-10" aria-hidden="true" tabindex="-1"></a><span class="co">#  mutate(days = as.integer(substr(days, 1, 3))) # drop all hours, minutes and seconds. Just keep days</span></span></code></pre></div>
</div>
<div id="model-estimation-number-of-topics" class="section level3 hasAnchor" number="8.3.3">
<h3><span class="header-section-number">8.3.3</span> Model estimation: Number of topics<a href="tidy-text-analysis.html#model-estimation-number-of-topics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Using our sparse matrix (<em>data_sparse</em>) and our time span (<em>date_covariate</em>), we can now calculate our topic models.</p>
<p>As an investigator, you must first estimate the number of topics you
anticipate to encounter across all documents (= the number of topics <em>K</em>
in a corpus) before fitting an LDA model. If you estimate there are
approximately 20 topics that your Twitter data cover, for example, you’ll set
<em>K</em> = 20 to extract 20 separate topics. The 20 topics are then extracted
from the corpus based on the distribution of co-occurring words in each
document. Choosing a good value for <em>K</em> is extremely important and
consequential, since it will impact your results. Usually, small <em>K</em>s
produce very distinct, but generalizable topics, while high <em>K</em>s produce
overlapping themes, but are also more event- and issue-specific.</p>
<p>Let’s create a topic model. More specifically, let’s create a six-topic
LDA model using <code>stm</code>. In practice, you would often use a higher
<em>K</em>, but for our use case, six should suffice. You copy this code and set
K = 6 in the tibble() function.</p>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="tidy-text-analysis.html#cb265-1" aria-hidden="true" tabindex="-1"></a>k_models <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">K =</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span></span>
<span id="cb265-2"><a href="tidy-text-analysis.html#cb265-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># provides stm with our sparse matrix (i.e., our data):</span></span>
<span id="cb265-3"><a href="tidy-text-analysis.html#cb265-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(K, <span class="sc">~</span> <span class="fu">stm</span>(data_sparse,</span>
<span id="cb265-4"><a href="tidy-text-analysis.html#cb265-4" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tells stm to use the value for K that was specified in the tibble() function:</span></span>
<span id="cb265-5"><a href="tidy-text-analysis.html#cb265-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">K =</span> .,</span>
<span id="cb265-6"><a href="tidy-text-analysis.html#cb265-6" aria-hidden="true" tabindex="-1"></a>  <span class="co"># models topics over days:</span></span>
<span id="cb265-7"><a href="tidy-text-analysis.html#cb265-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">prevalence =</span> <span class="sc">~</span> <span class="fu">s</span>(days),</span>
<span id="cb265-8"><a href="tidy-text-analysis.html#cb265-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tells stm where to draw the time span from:</span></span>
<span id="cb265-9"><a href="tidy-text-analysis.html#cb265-9" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> date_covariate,</span>
<span id="cb265-10"><a href="tidy-text-analysis.html#cb265-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># tells stm to print an output to the console so that you can keep track of its progress:</span></span>
<span id="cb265-11"><a href="tidy-text-analysis.html#cb265-11" aria-hidden="true" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb265-12"><a href="tidy-text-analysis.html#cb265-12" aria-hidden="true" tabindex="-1"></a>  <span class="co"># initializes the LDA algorithm (you could use others, e.g. &quot;spectral&quot;):</span></span>
<span id="cb265-13"><a href="tidy-text-analysis.html#cb265-13" aria-hidden="true" tabindex="-1"></a>                              <span class="at">init.type =</span> <span class="st">&quot;LDA&quot;</span>)))</span></code></pre></div>
<p>Depending on your machine, this code might run a while! So grab a coffee and come back later. :)</p>
<p>When your topic models are done (i.e., red stop sign in the R condole is no longer showing), you can extract your topics from the object that <code>stm</code> created and the effect that time has on your topic distribution. This is an important step for topic visualization!</p>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="tidy-text-analysis.html#cb266-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the topics</span></span>
<span id="cb266-2"><a href="tidy-text-analysis.html#cb266-2" aria-hidden="true" tabindex="-1"></a>lda <span class="ot">&lt;-</span> k_models <span class="sc">%&gt;%</span> </span>
<span id="cb266-3"><a href="tidy-text-analysis.html#cb266-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(K <span class="sc">==</span> <span class="dv">6</span>) <span class="sc">%&gt;%</span> <span class="co"># 6 to grab the model with ALL 6 topics</span></span>
<span id="cb266-4"><a href="tidy-text-analysis.html#cb266-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pull</span>(model) <span class="sc">%&gt;%</span> </span>
<span id="cb266-5"><a href="tidy-text-analysis.html#cb266-5" aria-hidden="true" tabindex="-1"></a>  .[[<span class="dv">1</span>]]</span>
<span id="cb266-6"><a href="tidy-text-analysis.html#cb266-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb266-7"><a href="tidy-text-analysis.html#cb266-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Extract the effect of time on topic distribution</span></span>
<span id="cb266-8"><a href="tidy-text-analysis.html#cb266-8" aria-hidden="true" tabindex="-1"></a>shiny_model <span class="ot">&lt;-</span> <span class="fu">estimateEffect</span>(<span class="at">formula=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">6</span><span class="sc">~</span><span class="fu">s</span>(days), <span class="at">stmobj=</span>lda, <span class="at">metadata=</span>date_covariate) <span class="co"># formula needs to be set from 1:6 to calculate the effect of time on all 6 topics</span></span></code></pre></div>
</div>
<div id="practice-model-estimation" class="section level3 unnumbered hasAnchor">
<h3>Practice: Model estimation<a href="tidy-text-analysis.html#practice-model-estimation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>(Install +) Load the <code>tidytext</code> and <code>stm</code> package. Next, cast the tidy text
data <em>data_tknzd</em> into a <em>sparse matrix</em> that the <code>stm</code> can use to
calculate topic models. Create a date covariate. Finally, estimate an LDA-based topic model with 3 (!!!) topics and extract the topics and the effect of time on the distribution of those 3 (!!!) topics.</p>
<p><em>Hints:</em> The Kliemann scandal started on May 6th 2022, so that’s your <em>min()</em> date.
In addition, the data sets covers several months, so you want to use full days for topic model visualization.</p>
</div>
<div id="inspect-the-topics" class="section level3 hasAnchor" number="8.3.4">
<h3><span class="header-section-number">8.3.4</span> Inspect the topics<a href="tidy-text-analysis.html#inspect-the-topics" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now it’s time to inspect our topics! A convenient way is to use the `<code>stminsights</code> package
that creates an app in which you can inspect the topic models interactively.</p>
<p>Let’s install and load <code>stminsights</code>.</p>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="tidy-text-analysis.html#cb267-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Install / load the stminsights package for topic modeling</span></span>
<span id="cb267-2"><a href="tidy-text-analysis.html#cb267-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(stminsights)) {</span>
<span id="cb267-3"><a href="tidy-text-analysis.html#cb267-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;stminsights&quot;</span>); </span>
<span id="cb267-4"><a href="tidy-text-analysis.html#cb267-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">require</span>(stminsights)</span>
<span id="cb267-5"><a href="tidy-text-analysis.html#cb267-5" aria-hidden="true" tabindex="-1"></a>} <span class="co">#load / install+load stminsights</span></span></code></pre></div>
<p>Once you start <code>stminsights</code>, the app needs an R environment that contains only three objects (shiny_model, lda, and out) that include important information for visualizing your topic models. Therefore, we need to save these three objects to our working directory, then clear our R environment, reload only these three objects and then create an image (our save file) of our R environemt.</p>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="tidy-text-analysis.html#cb268-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Save all files for the stminisghts app</span></span>
<span id="cb268-2"><a href="tidy-text-analysis.html#cb268-2" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(shiny_model, <span class="at">file =</span> <span class="st">&quot;shiny_model.rds&quot;</span>)</span>
<span id="cb268-3"><a href="tidy-text-analysis.html#cb268-3" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(lda, <span class="at">file =</span> <span class="st">&quot;lda.rds&quot;</span>)</span>
<span id="cb268-4"><a href="tidy-text-analysis.html#cb268-4" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">as.dfm</span>(data_sparse) <span class="co"># this reshapes our sparse matrix in a format that the stminsights app can read</span></span>
<span id="cb268-5"><a href="tidy-text-analysis.html#cb268-5" aria-hidden="true" tabindex="-1"></a><span class="fu">saveRDS</span>(out, <span class="at">file =</span> <span class="st">&quot;out.rds&quot;</span>)</span>
<span id="cb268-6"><a href="tidy-text-analysis.html#cb268-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-7"><a href="tidy-text-analysis.html#cb268-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Clear your entire environment</span></span>
<span id="cb268-8"><a href="tidy-text-analysis.html#cb268-8" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(<span class="at">list =</span> <span class="fu">ls</span>())</span>
<span id="cb268-9"><a href="tidy-text-analysis.html#cb268-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-10"><a href="tidy-text-analysis.html#cb268-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Load only the important files for stminisghts into your R environment</span></span>
<span id="cb268-11"><a href="tidy-text-analysis.html#cb268-11" aria-hidden="true" tabindex="-1"></a>shiny_model <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;shiny_model.rds&quot;</span>)</span>
<span id="cb268-12"><a href="tidy-text-analysis.html#cb268-12" aria-hidden="true" tabindex="-1"></a>lda <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;lda.rds&quot;</span>)</span>
<span id="cb268-13"><a href="tidy-text-analysis.html#cb268-13" aria-hidden="true" tabindex="-1"></a>out <span class="ot">&lt;-</span> <span class="fu">readRDS</span>(<span class="at">file =</span> <span class="st">&quot;out.rds&quot;</span>)</span>
<span id="cb268-14"><a href="tidy-text-analysis.html#cb268-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb268-15"><a href="tidy-text-analysis.html#cb268-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Create an image (or save file) of your R environment in your working directory</span></span>
<span id="cb268-16"><a href="tidy-text-analysis.html#cb268-16" aria-hidden="true" tabindex="-1"></a><span class="fu">save.image</span>(<span class="st">&#39;shiny_model.RData&#39;</span>)</span></code></pre></div>
<p>We’ve made it through the tutorial! Now it’s time to start our app with this code, click on “browse” and upload the saved file called “shiny_model” from our working directory.</p>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="tidy-text-analysis.html#cb269-1" aria-hidden="true" tabindex="-1"></a><span class="fu">run_stminsights</span>()</span></code></pre></div>
</div>
<div id="practice-inspect-models" class="section level3 unnumbered hasAnchor">
<h3>Practice: Inspect models<a href="tidy-text-analysis.html#practice-inspect-models" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Install + load the <code>stminsights</code> package. Create all the save files you need, clear your R environment and reload the important R objects. Create an image of your R environment. Finally, start the <code>stminsights</code> app and upload your shiny_model via the browse-button.</p>
</div>
<div id="find-the-best-value-for-k" class="section level3 hasAnchor" number="8.3.5">
<h3><span class="header-section-number">8.3.5</span> Find the best value for K<a href="tidy-text-analysis.html#find-the-best-value-for-k" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>While the quality of our six topics may appear satisfactory to you (but most likely not), we must remember that our choice of <em>K</em> was purely arbitrary. Post-hoc rationalization of this choice is inherently problematic. If possible, you should base your choice of <em>K</em> on previous literature and what researchers have said about a suitable <em>K</em> for your corpus / your research question. If no such information is available, the below code allows you to create two plots to investigate the best value for <em>K</em>. The code takes a range of <em>K</em> values, calculates topic models for each value of <em>K</em>, and then plots goodness-of-fit measurements that indicate what value for <em>K</em> fits the data best. !! Depending on your range of <em>K</em> and data size, this code can take a while to run !!</p>
<p>Please keep in mind that this graphical assessment must always be accompanied by critical re-reading and examination of the topics and documents (e.g., with regard to human-inferred <em>semantic coherence</em> and <em>exclusivity</em> of topics).</p>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="tidy-text-analysis.html#cb270-1" aria-hidden="true" tabindex="-1"></a>k_models <span class="ot">&lt;-</span> <span class="fu">tibble</span>(<span class="at">K =</span> <span class="fu">seq</span>(<span class="dv">6</span>,<span class="dv">12</span>)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-2"><a href="tidy-text-analysis.html#cb270-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">model =</span> <span class="fu">map</span>(K, <span class="sc">~</span> <span class="fu">stm</span>(data_sparse,</span>
<span id="cb270-3"><a href="tidy-text-analysis.html#cb270-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">K =</span> .,</span>
<span id="cb270-4"><a href="tidy-text-analysis.html#cb270-4" aria-hidden="true" tabindex="-1"></a>                              <span class="at">prevalence =</span> <span class="sc">~</span> <span class="fu">s</span>(days),</span>
<span id="cb270-5"><a href="tidy-text-analysis.html#cb270-5" aria-hidden="true" tabindex="-1"></a>                              <span class="at">data =</span> date_covariate,</span>
<span id="cb270-6"><a href="tidy-text-analysis.html#cb270-6" aria-hidden="true" tabindex="-1"></a>                              <span class="at">verbose =</span> <span class="cn">TRUE</span>,</span>
<span id="cb270-7"><a href="tidy-text-analysis.html#cb270-7" aria-hidden="true" tabindex="-1"></a>                              <span class="at">init.type =</span> <span class="st">&quot;LDA&quot;</span>)))</span>
<span id="cb270-8"><a href="tidy-text-analysis.html#cb270-8" aria-hidden="true" tabindex="-1"></a>heldout <span class="ot">&lt;-</span> <span class="fu">make.heldout</span>(data_sparse)</span>
<span id="cb270-9"><a href="tidy-text-analysis.html#cb270-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-10"><a href="tidy-text-analysis.html#cb270-10" aria-hidden="true" tabindex="-1"></a>model_scores <span class="ot">&lt;-</span> k_models <span class="sc">%&gt;%</span> </span>
<span id="cb270-11"><a href="tidy-text-analysis.html#cb270-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">exclusivity =</span> <span class="fu">map</span>(model, exclusivity),</span>
<span id="cb270-12"><a href="tidy-text-analysis.html#cb270-12" aria-hidden="true" tabindex="-1"></a>         <span class="at">semantic_coherence =</span> <span class="fu">map</span>(model, semanticCoherence, data_sparse),</span>
<span id="cb270-13"><a href="tidy-text-analysis.html#cb270-13" aria-hidden="true" tabindex="-1"></a>         <span class="at">eval_heldout =</span> <span class="fu">map</span>(model, eval.heldout, heldout<span class="sc">$</span>missing),</span>
<span id="cb270-14"><a href="tidy-text-analysis.html#cb270-14" aria-hidden="true" tabindex="-1"></a>         <span class="at">residual =</span> <span class="fu">map</span>(model, checkResiduals, data_sparse),</span>
<span id="cb270-15"><a href="tidy-text-analysis.html#cb270-15" aria-hidden="true" tabindex="-1"></a>         <span class="at">bound =</span>  <span class="fu">map_dbl</span>(model, <span class="cf">function</span>(x) <span class="fu">max</span>(x<span class="sc">$</span>convergence<span class="sc">$</span>bound)),</span>
<span id="cb270-16"><a href="tidy-text-analysis.html#cb270-16" aria-hidden="true" tabindex="-1"></a>         <span class="at">lfact =</span> <span class="fu">map_dbl</span>(model, <span class="cf">function</span>(x) <span class="fu">lfactorial</span>(x<span class="sc">$</span>settings<span class="sc">$</span>dim<span class="sc">$</span>K)),</span>
<span id="cb270-17"><a href="tidy-text-analysis.html#cb270-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">lbound =</span> bound <span class="sc">+</span> lfact,</span>
<span id="cb270-18"><a href="tidy-text-analysis.html#cb270-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">iterations =</span> <span class="fu">map_dbl</span>(model, <span class="cf">function</span>(x) <span class="fu">length</span>(x<span class="sc">$</span>convergence<span class="sc">$</span>bound)))</span>
<span id="cb270-19"><a href="tidy-text-analysis.html#cb270-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-20"><a href="tidy-text-analysis.html#cb270-20" aria-hidden="true" tabindex="-1"></a>plot1 <span class="ot">&lt;-</span> model_scores <span class="sc">%&gt;%</span></span>
<span id="cb270-21"><a href="tidy-text-analysis.html#cb270-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(K, exclusivity, semantic_coherence) <span class="sc">%&gt;%</span> </span>
<span id="cb270-22"><a href="tidy-text-analysis.html#cb270-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unnest</span>(<span class="fu">c</span>(exclusivity, semantic_coherence)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-23"><a href="tidy-text-analysis.html#cb270-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(K) <span class="sc">%&gt;%</span> </span>
<span id="cb270-24"><a href="tidy-text-analysis.html#cb270-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarize</span>(<span class="at">exclusivity =</span> <span class="fu">mean</span>(exclusivity),</span>
<span id="cb270-25"><a href="tidy-text-analysis.html#cb270-25" aria-hidden="true" tabindex="-1"></a>            <span class="at">semantic_coherence =</span> <span class="fu">mean</span>(semantic_coherence)) <span class="sc">%&gt;%</span> </span>
<span id="cb270-26"><a href="tidy-text-analysis.html#cb270-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> semantic_coherence, <span class="at">y =</span> exclusivity, <span class="at">color =</span> K, <span class="at">label =</span> K)) <span class="sc">+</span></span>
<span id="cb270-27"><a href="tidy-text-analysis.html#cb270-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb270-28"><a href="tidy-text-analysis.html#cb270-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="at">nudge_y =</span> <span class="fl">0.001</span>) <span class="sc">+</span></span>
<span id="cb270-29"><a href="tidy-text-analysis.html#cb270-29" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb270-30"><a href="tidy-text-analysis.html#cb270-30" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Semantic coherence&quot;</span>,</span>
<span id="cb270-31"><a href="tidy-text-analysis.html#cb270-31" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Exclusivity&quot;</span>,</span>
<span id="cb270-32"><a href="tidy-text-analysis.html#cb270-32" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Comparing exclusivity and semantic coherence&quot;</span>,</span>
<span id="cb270-33"><a href="tidy-text-analysis.html#cb270-33" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Models with fewer topics have higher semantic coherence,</span><span class="sc">\n</span><span class="st">but lower exclusivity&quot;</span>)</span>
<span id="cb270-34"><a href="tidy-text-analysis.html#cb270-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-35"><a href="tidy-text-analysis.html#cb270-35" aria-hidden="true" tabindex="-1"></a>plot1</span>
<span id="cb270-36"><a href="tidy-text-analysis.html#cb270-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-37"><a href="tidy-text-analysis.html#cb270-37" aria-hidden="true" tabindex="-1"></a>plot2 <span class="ot">&lt;-</span> model_scores <span class="sc">%&gt;%</span></span>
<span id="cb270-38"><a href="tidy-text-analysis.html#cb270-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">transmute</span>(K,</span>
<span id="cb270-39"><a href="tidy-text-analysis.html#cb270-39" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Lower bound</span><span class="st">`</span> <span class="ot">=</span> lbound,</span>
<span id="cb270-40"><a href="tidy-text-analysis.html#cb270-40" aria-hidden="true" tabindex="-1"></a>            <span class="at">Residuals =</span> <span class="fu">map_dbl</span>(residual, <span class="st">&quot;dispersion&quot;</span>),</span>
<span id="cb270-41"><a href="tidy-text-analysis.html#cb270-41" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Semantic coherence</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">map_dbl</span>(semantic_coherence, mean),</span>
<span id="cb270-42"><a href="tidy-text-analysis.html#cb270-42" aria-hidden="true" tabindex="-1"></a>            <span class="st">`</span><span class="at">Held-out likelihood</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">map_dbl</span>(eval_heldout, <span class="st">&quot;expected.heldout&quot;</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb270-43"><a href="tidy-text-analysis.html#cb270-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">gather</span>(Metric, Value, <span class="sc">-</span>K) <span class="sc">%&gt;%</span></span>
<span id="cb270-44"><a href="tidy-text-analysis.html#cb270-44" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(K, Value, <span class="at">fill =</span> <span class="st">&quot;black&quot;</span>)) <span class="sc">+</span></span>
<span id="cb270-45"><a href="tidy-text-analysis.html#cb270-45" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">size =</span> <span class="fl">1.0</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">show.legend =</span> <span class="cn">FALSE</span>) <span class="sc">+</span></span>
<span id="cb270-46"><a href="tidy-text-analysis.html#cb270-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Metric, <span class="at">scales =</span> <span class="st">&quot;free_y&quot;</span>) <span class="sc">+</span></span>
<span id="cb270-47"><a href="tidy-text-analysis.html#cb270-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;K (number of topics)&quot;</span>,</span>
<span id="cb270-48"><a href="tidy-text-analysis.html#cb270-48" aria-hidden="true" tabindex="-1"></a>       <span class="at">y =</span> <span class="cn">NULL</span>,</span>
<span id="cb270-49"><a href="tidy-text-analysis.html#cb270-49" aria-hidden="true" tabindex="-1"></a>       <span class="at">title =</span> <span class="st">&quot;Model diagnostics&quot;</span>,</span>
<span id="cb270-50"><a href="tidy-text-analysis.html#cb270-50" aria-hidden="true" tabindex="-1"></a>       <span class="at">subtitle =</span> <span class="st">&quot;Held-out likelihood &amp; coherence should be maximized,</span><span class="sc">\n</span><span class="st">residuals &amp; lower bound should be minimized&quot;</span>)</span>
<span id="cb270-51"><a href="tidy-text-analysis.html#cb270-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb270-52"><a href="tidy-text-analysis.html#cb270-52" aria-hidden="true" tabindex="-1"></a>plot2</span></code></pre></div>
<p><strong>Hands-on learning for data journalists:</strong> As you can see, topic modeling can turn into “reading tea leaves” (<a href="https://proceedings.neurips.cc/paper/2009/file/f92586a25bb3145facd64ab20fd554ff-Paper.pdf">Chang et al., 2009</a>). Depending on how many topics are extracted (number <em>K</em>) and how the data preprocessing was done, one can get very different results. Therefore, you should carefully review topic reports (e.g., the Meltwater’s Key Messages report). Please do not trust such automated analyses blindly.</p>
</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="4">
<li id="fn4"><p>To disable this feature, use the to_lower = FALSE option.<a href="tidy-text-analysis.html#fnref4" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="exercise-5-test-your-knowledge.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="solutions.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/LKobilke/data-journalism/edit/main/index.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Data Journalism.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

</body>

</html>
